T5G16000","AT5G16010","AT5G16023","AT5G16030","AT5G16200","AT5G16210","AT5G17920","AT5G17930","AT5G18010","AT5G18020","AT5G18030","AT5G18020","AT5G18030","AT5G18050","AT5G18060","AT5G18050","AT5G18060","AT5G18080","AT5G18310","AT5G18310","AT5G18650","AT5G18860","AT5G19190","AT5G19190","AT5G19200","AT5G19729","AT5G19730","AT5G20110","AT5G20180","AT5G20181","AT5G20170","AT5G20190","AT5G20700","AT5G20710","AT5G21940","AT5G21990","AT5G22740","AT5G22940","AT5G23280","AT5G23860","AT5G23870","AT5G24600","AT5G24610","AT5G25290","AT5G25460","AT5G25460","AT5G27210","AT5G27220","AT5G28020","AT5G28145","AT5G28300","AT5G39860","AT5G40340","AT5G41130","AT5G41590","AT5G41600","AT5G41905","AT5G41908","AT5G42380","AT5G42390","AT5G42900","AT5G43020","AT5G43270","AT5G43760","AT5G43890","AT5G44210","AT5G44220","AT5G44220","AT5G45340","AT5G46250","AT5G46320","AT5G46330","AT5G46690","AT5G47370","AT5G47370","AT5G47380","AT5G47500","AT5G47510","AT5G47635","AT5G47640","AT5G47818","AT5G47820","AT5G48150","AT5G48540","AT5G48900","AT5
G48905","AT5G49090","AT5G49100","AT5G49100","AT5G49690","AT5G49700","AT5G51460","AT5G51790","AT5G52400","AT5G52570","AT5G52580","AT5G52890","AT5G52900","AT5G52901","AT5G53400","AT5G53510","AT5G53970","AT5G53980","AT5G54380","AT5G54470","AT5G54480","AT5G54510","AT5G54580","AT5G54585","AT5G54590","AT5G55120","AT5G56040","AT5G57780","AT5G57780","AT5G58310","AT5G58320","AT5G58530","AT5G58650","AT5G58660","AT5G59020","AT5G59480","AT5G59505","AT5G59510","AT5G59790","AT5G60670","AT5G60680","AT5G60840","AT5G60860","AT5G60880","AT5G60890","AT5G61520","AT5G61530","AT5G61660","AT5G61670","AT5G61997","AT5G62220","AT5G62290","AT5G62350","AT5G62460","AT5G62660","AT5G62670","AT5G64210","AT5G64220","AT5G64260","AT5G64260","AT5G64750","AT5G65300","AT5G65390","AT5G65400","AT5G65470","AT5G65670","AT5G65800","AT5G66080","AT5G66090","AT5G66210","AT5G66211","AT5G66310","AT5G66310","AT5G66580","AT5G66590","AT5G66631","AT5G66640","AT5G66675","AT5G67190","AT5G67290","AT5G67300","AT5G67360","AT5G67411","AT5G67420")
summary(unique(PIF5target))
46/1218*100
library(ggplot2)
?theme
2316  + 26478
length(blastn.Kit.cuffcmp.classu.102613.1.nocom$gene)
?grep
?gsub
422 -346
1e-1
rowSums
?rowSums
?matrix
?write.table
?read.csv
4/5
average.hyp.shade<-4
c(4,5,6)/average.hyp.shade
data<-data.frame(trt=c(rep("sun",10),rep("shade",10)),length=c(rnorm(10,2),rnorm(10,4))
)
data
data<-data.frame(trt=c(rep("sun",10),rep("shade",10)),length=c(rnorm(10,2,sd=0.2),rnorm(10,4,sd=0.4)))
data
tapply(data,2,mean)
tapply(data$length,data$trt,mean)
data
data<-data.frame(trt=c(rep("sun",10),rep("shade",10)),length=c(rnorm(10,2,sd=0.2),rnorm(10,4,sd=0.4)))
rep("sun",10)
hist(rnorm(10,2,sd=0.2))
data
tapply(data$length,data$trt,mean)
temp<-tapply(data$length,data$trt,mean)
data[1:10,]/temp[1]
data[11:20,]/temp[2]
data[11:20,]/temp[,2]
data[11:20,2]/temp[2]
data[1:10,2]/temp[1]
log2(1)
log2(0.5)
examples(ftable)
example(ftable)
mtcars
?grep
?match
?grep
229+76
229+76 + 89 + 79
R/FR function#
R_FR_ratio<-function(spec,resolution){ #1st column is wavelength(nm), 2nd column is fluence rate (micro E) measured by Black Comet	#
	#print(as.character(spec))#
	R<-sum(as.numeric(as.vector(spec[as.vector(spec[,1])>=655&as.vector(spec[,1])<=665,2])))* resolution;#print(paste("R=",R)) #
	FR<-sum(as.numeric(as.vector(spec[as.vector(spec[,1])>=725&as.vector(spec[,1])<=735,2])))* resolution;#print(paste("FR=",FR))#
	#print(paste("R/FR=",R/FR))#
	return(R/FR)#
	}#
#PAR function#
PAR<-function(spec, resolution){#
	PAR.microE<-sum(as.numeric(as.vector(spec[as.vector(spec[,1])>=400&as.vector(spec[,1])<=700,2])))* resolution#
	return(PAR.microE)#
	}#
#### plot#
spec.graph2<-function(specdata,resolution, color,title) #1s column of specdata is wavelength(nm), 2nd column are fluence rate measured by Black Comet. color is "black", "red", "blue", "gree", "pink", etc#
{#
	file.name<-gsub(" ","_",gsub(":","",Sys.time()))#
	pdf(file=paste("spec",file.name,".pdf",sep=""),width=11,height=8)#
	matplot(x=specdata[-dim(specdata)[1],1],y=specdata[-dim(specdata)[1],2],ylim=c(0,max(specdata[-dim(specdata)[1],2]*1.2)),xlim=c(min(as.numeric(as.character(specdata[-dim(specdata)[1],1]))),max(as.numeric(as.character(specdata[-dim(specdata)[1],1])))),ylab="fluence rate (ÂµE)",xlab="wavelength (nm)", col=color, type="l",main=title)#
	dev.off()#
}
log2(10)
library(ggplot2)#
library(reshape2)#
library(ggdendro)#
#
data(mtcars)#
x <- as.matrix(scale(mtcars))#
dd.col <- as.dendrogram(hclust(dist(x)))#
col.ord <- order.dendrogram(dd.col)#
#
dd.row <- as.dendrogram(hclust(dist(t(x))))#
row.ord <- order.dendrogram(dd.row)#
#
xx <- scale(mtcars)[col.ord, row.ord]#
xx_names <- attr(xx, "dimnames")#
df <- as.data.frame(xx)#
colnames(df) <- xx_names[[2]]#
df$car <- xx_names[[1]]#
df$car <- with(df, factor(car, levels=car, ordered=TRUE))#
#
mdf <- melt(df, id.vars="car")#
ddata_x <- dendro_data(dd.row)#
ddata_y <- dendro_data(dd.col)
Set up a blank theme#
theme_none <- theme(#
  panel.grid.major = element_blank(),#
  panel.grid.minor = element_blank(),#
  panel.background = element_blank(),#
  axis.title.x = element_text(colour=NA),#
  axis.title.y = element_blank(),#
  axis.text.x = element_blank(),#
  axis.text.y = element_blank(),#
  axis.line = element_blank()#
  #axis.ticks.length = element_blank()#
)#
#
### Create plot components ###    #
# Heatmap#
p1 <- ggplot(mdf, aes(x=variable, y=car)) + #
  geom_tile(aes(fill=value)) + scale_fill_gradient2()
p1
mdf
q()
?acast
library(reshape2)
?acast
acast(aqm, day ~ month ~ variable)
names(airquality) <- tolower(names(airquality))#
aqm <- melt(airquality, id=c("month", "day"), na.rm=TRUE)
aqm
acast(aqm, day ~ month ~ variable)
temp<-acast(aqm, day ~ month ~ variable)
class(temp)
temp
x<-acast(aqm, day ~ month ~ variable)
x[,,temp]
x[,,"temp"]
aqm
tapply(aqm,variable,mean)
tapply(aqm, aqm$variable,mean)
tapply(aqm$value, aqm$variable,mean)
head(aqm)
tapply(aqm$value, list(aqm$day,aqm$variable),mean)
aqm$day<-factor(aqm$day)
tapply(aqm$value, list(aqm$day,aqm$variable),mean)
summary(aqm)
table(aqm$day)
aqm.mean<-tapply(aqm$value, list(aqm$day,aqm$variable),mean)
aqm.mean[1,"ozone"]
aqm[aqm$variable=="ozone",]
aqm[aqm$variable=="ozone",]/aqm.mean[1,"ozone"]
aqm[aqm$variable=="ozone","value"]/aqm.mean[1,"ozone"]
aqm.ozone<-aqm[aqm$variable=="ozone",]
aqm.ozone
aqm.ozone$relative<-aqm[aqm$variable=="ozone","value"]/aqm.mean[1,"ozone"]
aqm.ozone
log2(1)
5.4466E-06
0.000994507
0.000994507<0.0001
0.000994507<0.001
citation(lme4)
library(lme4)
citation(lme4)
citation("lme4")
library("lmerTest")
citation("lmerTest")
download data sheet from Google Drive "auxin_mutants_SAS_data_KN"#
NFY.FBHs.SAS.data<-read.csv("/Volumes/Data7/Arabi_SAS_phenotyping/SAS_analysis_NFY_FBHs/NFY_FBHs.csv")#
NFY.FBHs.SAS.data$petiole_leafblade<-NFY.FBHs.SAS.data$petioleLength/NFY.FBHs.SAS.data$bladeLength#
NFY.FBHs.SAS.data$treatment<-relevel(NFY.FBHs.SAS.data$treatment,ref="sun")#
library(reshape2)#
library(ggplot2)#
calc.sem <- function(y) {#
	y <- y[complete.cases(y)]#
	mean.y <- mean(y)#
	sem.y <- sd(y)/sqrt(length(y))#
	data.frame(ymax=mean.y+sem.y,ymin=mean.y-sem.y)#
	}#
# leaf 3-6 only#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]
petiole_leafblade#
## ggplot version (111713)#
p4b<-ggplot(NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$set=="2",], aes(x= treatment, y=petiole_leafblade,color=treatment)) #
p4b<-p4b + stat_summary(fun.y = "mean", geom = "bar", width = 0.3, fill="white") + xlab("test") + geom_jitter()#
p4b<-p4b + stat_summary(fun.data="calc.sem",geom="errorbar",position="dodge")#
p4b<-p4b+facet_grid(plant~leaf)#
p4b<-p4b + theme(strip.text.y = element_text(colour = "black", angle = 0, size = 8,hjust = 0.5, vjust = 0.5))
library(reshape2)#
library(ggplot2)#
calc.sem <- function(y) {#
	y <- y[complete.cases(y)]#
	mean.y <- mean(y)#
	sem.y <- sd(y)/sqrt(length(y))#
	data.frame(ymax=mean.y+sem.y,ymin=mean.y-sem.y)#
	}#
# leaf 3-6 only#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]
petiole_leafblade#
## ggplot version (111713)#
p4b<-ggplot(NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$set=="2",], aes(x= treatment, y=petiole_leafblade,color=treatment)) #
p4b<-p4b + stat_summary(fun.y = "mean", geom = "bar", width = 0.3, fill="white") + xlab("test") + geom_jitter()#
p4b<-p4b + stat_summary(fun.data="calc.sem",geom="errorbar",position="dodge")#
p4b<-p4b+facet_grid(plant~leaf)#
p4b<-p4b + theme(strip.text.y = element_text(colour = "black", angle = 0, size = 8,hjust = 0.5, vjust = 0.5))
p4
p4b
library(lme4);library(lmerTest);library(ggplot2);library(reshape2)
NFY.FBHs.SAS.data<-read.csv("/Volumes/Data7/Arabi_SAS_phenotyping/SAS_analysis_NFY_FBHs/NFY_FBHs.csv")
head(NFY.FBHs.SAS.data)
ggplot version (111713)#
p4b<-ggplot(NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$set=="2",], aes(x= treatment, y=petiole_leafblade,color=treatment)) #
p4b<-p4b + stat_summary(fun.y = "mean", geom = "bar", width = 0.3, fill="white") + xlab("test") + geom_jitter()#
p4b<-p4b + stat_summary(fun.data="calc.sem",geom="errorbar",position="dodge")#
p4b<-p4b+facet_grid(plant~leaf)#
p4b<-p4b + theme(strip.text.y = element_text(colour = "black", angle = 0, size = 8,hjust = 0.5, vjust = 0.5))#
p4b
NFY.FBHs.SAS.data$petiole_leafblade<-NFY.FBHs.SAS.data$petioleLength/NFY.FBHs.SAS.data$bladeLength#
NFY.FBHs.SAS.data$treatment<-relevel(NFY.FBHs.SAS.data$treatment,ref="sun")#
library(reshape2)#
library(ggplot2)#
calc.sem <- function(y) {#
	y <- y[complete.cases(y)]#
	mean.y <- mean(y)#
	sem.y <- sd(y)/sqrt(length(y))#
	data.frame(ymax=mean.y+sem.y,ymin=mean.y-sem.y)#
	}
ggplot version (111713)#
p4b<-ggplot(NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$set=="2",], aes(x= treatment, y=petiole_leafblade,color=treatment)) #
p4b<-p4b + stat_summary(fun.y = "mean", geom = "bar", width = 0.3, fill="white") + xlab("test") + geom_jitter()#
p4b<-p4b + stat_summary(fun.data="calc.sem",geom="errorbar",position="dodge")#
p4b<-p4b+facet_grid(plant~leaf)#
p4b<-p4b + theme(strip.text.y = element_text(colour = "black", angle = 0, size = 8,hjust = 0.5, vjust = 0.5))#
p4b
p3b<-ggplot(NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$set=="2",], aes(x= treatment, y=petioleLength,color=treatment)) #
p3b<-p3b + stat_summary(fun.y = "mean", geom = "bar", width = 0.3, fill="white") + xlab("test") + geom_jitter()#
p3b<-p3b + stat_summary(fun.data="calc.sem",geom="errorbar",position="dodge")#
p3b<-p3b+facet_grid(plant~leaf)#
p3b<-p3b + theme(strip.text.y = element_text(colour = "black", angle = 0, size = 8,hjust = 0.5, vjust = 0.5))#
p3b
p4b
lme1 <- lmer(petioleLength~plant*treatment+(1|rep) + (1|leaf),data=auxmut.SAS.data.leaf3_6)
lme1 <- lmer(petioleLength~plant*treatment+(1|rep) + (1|leaf),data=NFY.FBHs.SAS.data)
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data)
head(NFY.FBHs.SAS.data)#
# leaf 3-6 only#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]#
str(NFY.FBHs.SAS.data.leaf3_6)#
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
library(lme4);library(lmerTest);library(ggplot2);library(reshape2)
NFY.FBHs.SAS.data<-read.csv("/Volumes/Data7/Arabi_SAS_phenotyping/SAS_analysis_NFY_FBHs/NFY_FBHs.csv")#
NFY.FBHs.SAS.data$petiole_leafblade<-NFY.FBHs.SAS.data$petioleLength/NFY.FBHs.SAS.data$bladeLength#
NFY.FBHs.SAS.data$treatment<-relevel(NFY.FBHs.SAS.data$treatment,ref="sun")#
library(reshape2)#
library(ggplot2)#
calc.sem <- function(y) {#
	y <- y[complete.cases(y)]#
	mean.y <- mean(y)#
	sem.y <- sd(y)/sqrt(length(y))#
	data.frame(ymax=mean.y+sem.y,ymin=mean.y-sem.y)#
	}#
# leaf 3-6 only#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
leaf 3-6 only#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]#
str(NFY.FBHs.SAS.data.leaf3_6)#
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
str(NFY.FBHs.SAS.data.leaf3_6)
NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$plant="b2_b3"|NFY.FBHs.SAS.data.leaf3_6$plant="Col"|NFY.FBHs.SAS.data.leaf3_6$plant="nfy",]
str(NFY.FBHs.SAS.data.leaf3_6)#
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
summary(NFY.FBHs.SAS.data.leaf3_6)
NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$set==2,]
str(NFY.FBHs.SAS.data.leaf3_6)#
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
summary(NFY.FBHs.SAS.data.leaf3_6)
NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$plant="b2_b3"|NFY.FBHs.SAS.data.leaf3_6$plant="Col"|NFY.FBHs.SAS.data.leaf3_6$plant="nfy",]#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$set==2,]#
	summary(NFY.FBHs.SAS.data.leaf3_6)
NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$plant=="b2_b3"|NFY.FBHs.SAS.data.leaf3_6$plant=="Col"|NFY.FBHs.SAS.data.leaf3_6$plant=="nfy",]#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$set==2,]#
	summary(NFY.FBHs.SAS.data.leaf3_6)#
str(NFY.FBHs.SAS.data.leaf3_6)#
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lme1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
lme1
lmer1
lmer1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)
lmer1
summary(lmer1)$coefficients
NFY.FBHs.SAS.data$plant<-relevel9NFY.FBHs.SAS.data$plant,ref="Col")
NFY.FBHs.SAS.data$plant<-relevel(NFY.FBHs.SAS.data$plant,ref="Col")
NFY.FBHs.SAS.data$treatment<-relevel(NFY.FBHs.SAS.data$treatment,ref="sun")
leaf 3-6 only#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data[NFY.FBHs.SAS.data$leaf=="3"|NFY.FBHs.SAS.data$leaf=="4"|NFY.FBHs.SAS.data$leaf=="5"|NFY.FBHs.SAS.data$leaf=="6",]#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$plant=="b2_b3"|NFY.FBHs.SAS.data.leaf3_6$plant=="Col"|NFY.FBHs.SAS.data.leaf3_6$plant=="nfy",]#
	NFY.FBHs.SAS.data.leaf3_6<-NFY.FBHs.SAS.data.leaf3_6[NFY.FBHs.SAS.data.leaf3_6$set==2,]#
	summary(NFY.FBHs.SAS.data.leaf3_6)#
str(NFY.FBHs.SAS.data.leaf3_6)#
NFY.FBHs.SAS.data.leaf3_6$rep<-as.factor(NFY.FBHs.SAS.data.leaf3_6$rep)#
NFY.FBHs.SAS.data.leaf3_6$set<-as.factor(NFY.FBHs.SAS.data.leaf3_6$set)#
NFY.FBHs.SAS.data.leaf3_6$leaf<-as.factor(NFY.FBHs.SAS.data.leaf3_6$leaf)#
lmer1 <- lmer(petioleLength~plant*treatment + (1|leaf),data=NFY.FBHs.SAS.data.leaf3_6)#
summary(lmer1)$coefficients
download data sheet from Google Drive "auxin_mutants_SAS_data_KN"#
aux.mut.SAS.data<-read.csv("/Volumes/Data7/Arabi_SAS_phenotyping/Arbi_adult_SAS_auxin_mutant/auxin_mut_leaf_SAS_data - Sheet1.csv")#
aux.mut.SAS.data$petiole_leafblade<-aux.mut.SAS.data$petioleLength/aux.mut.SAS.data$bladeLength#
aux.mut.SAS.data$treatment<-relevel(aux.mut.SAS.data$treatment,ref="sun")
summary(aux.mut.SAS.data)
table(aux.mut.SAS.data$file)
251,999*0.8
251999*0.8
300000*0.8
?gsub
?melt
library(reshape2)
?melt
names(airquality) <- tolower(names(airquality))#
melt(airquality, id=c("month", "day"))
?reshpae
head(temp)
237/296
237/300
237/296
238/296
235/296
234/296
233/296
232/296
library(ggplot2)
?theme
library(ggplot2)
?geom_tile
?melt
library(reshape2)
?melt
airquality
melt(airquality, id=c("month", "day"))
names(airquality) <- tolower(names(airquality))
melt(airquality, id=c("month", "day"))
?Term
library(annotate)
?Term
gonode <- new("GOTerms", GOID="GO:1234567", Term="Test", Ontology="MF",#
                          Definition="just for testing")#
  GOID(gonode)#
  Term(gonode)#
  Ontology(gonode)
gonode
Term("GO:1234567")
Term(GO:1234567)
Term(GOID="GO:1234567")
Term(GOID:"GO:1234567")
Term("GO:1234567")
GOID(gonode)
Ontology(gonode)
?read
?read.table
library(shortread)
library(shortreads)
library(Biostrings)
?fastafile
fasta.info(consensus.seq)
format.luc2data<-function(plant.name,luc2.data,files) { #
#names(sample.num)<-c("shade","sun")#
# extract genotype and sample number, line name#
genotype<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)","\\5",plant.name)#
sample.num<-c(length(grep("shade",gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)","\\1",plant.name))),length(grep("sun",gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)","\\1",plant.name))))#
names(sample.num)<-c("shade","sun")#
line<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)","\\7",plant.name)#
# format luc2.data#
set.files<-levels(as.factor(gsub("([[:print:]]+)(exp[[:digit:]]+)","\\2",luc2.data$Label))) # and needs to eliminate "set2.tif:exp5label"#
set.files<-grep("label",set.files,invert=TRUE,value=TRUE)#
luc2.data$treatment<-rep(rep(c("shade","sun"),c(sample.num["shade"],sample.num["sun"])),length(set.files)) # this is wrong?#
luc2.data$promoter<-rep(genotype,length(set.files))#
luc2.data$line<-rep(line,length(set.files))#
#
# add time point info (under construction)#
print(files)#
files$date.time<-strptime(paste(files$V6,files$V7,files$V8,sep="/"),"%b/%d/%H:%M")#
print(files)#
#
luc2.data$date.time<-strptime("","%b/%d/%H:%M")#
luc2.data$exp.file<-gsub("([[:print:]]+)(exp[[:digit:]]+)","\\2",luc2.data$Label)#
for(i in 1:dim(luc2.data)[1]) {#
luc2.data[i,"date.time"]<-as.character(files[gsub("(exp[[:digit:]]+)(.tif)","\\1",files$V9)==luc2.data$exp.file[i],"date.time"])#
}#
#
#luc2.data$ZT<-luc2.data$date.time - sort(luc2.data$date.time)[1] # this is sec. how to change into hr?#
#as.difftime(c(luc2.data$date.time,rep(sort(luc2.data$date.time)[1],dim(luc2.data$date.time)[1]), units = "hours",format="%b/%d/%H:%M")#
luc2.data$ZT<-as.numeric(luc2.data$date.time - sort(luc2.data$date.time)[1], units = "hours",format="%b/%d/%H:%M")	#
# reshape? and substract values in before shade treatment#
#luc2.data.reshape<-reshape(***********) # under construction#
#
	return(luc2.data)#
}#
#
# functin for "multi" output (under construction)#
format.luc2data.multi<-function(plant.name,luc2.data,luc2.data.multi,files,first_day_ZT0) { #
	temp.multi<-luc2.data.multi[,c("Slice",grep("^IntDen",names(luc2.data.multi),value=TRUE))]#
	# add file name#
	set.files<-unique(gsub("([[:print:]]+)(exp[[:digit:]]+)","\\2",luc2.data$Label)) # keeping file order (by time)#
	#print(set.files)#
	# remove label file#
	temp.multi$setfiles<-set.files#
	temp.multi<-temp.multi[grep("lab",temp.multi$setfiles,invert=TRUE),]#
#
	# calculate increase/decrease from begining#
#	temp.multi.dif<-as.matrix(temp.multi[,-1])-as.vector(temp.multi[1,-1]) # does not work#
	temp.multi.dif<-sweep(data.matrix(temp.multi[,grep("IntDen",names(temp.multi))]),2,data.matrix(temp.multi[1,grep("IntDen",names(temp.multi))]))#
	temp.multi.dif<-as.data.frame(temp.multi.dif)#
	temp.multi.dif<-cbind(temp.multi.dif,temp.multi$setfiles)#
	names(temp.multi.dif)[grep("setfiles",names(temp.multi.dif))]<-"setfiles"#
	#print(temp.multi.dif)#
#
	# add sample names#
	names(temp.multi.dif)[grep("IntDen",names(temp.multi.dif))]<-plant.name#
	temp.multi.dif#
	print(temp.multi.dif) # Error: id variables not found in data: setfiles#
	# melt#
	temp.multi.dif.melt<-melt(temp.multi.dif,id.var="setfiles")#
#
	# treatment#
	temp.multi.dif.melt$treatment<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)(_)(rep[[:digit:]])","\\1",temp.multi.dif.melt$variable)#
	# promoter#
	temp.multi.dif.melt$promoter<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)(_)(rep[[:digit:]])","\\5",temp.multi.dif.melt$variable)#
	# line#
	temp.multi.dif.melt$line<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)(_)(rep[[:digit:]])","\\7",temp.multi.dif.melt$variable)	#
# add time point info (under construction)#
#print(files)#
files$date.time<-strptime(paste(files$V6,files$V7,files$V8,sep="/"),"%b/%d/%H:%M")#
#print(files)#
#
temp.multi.dif.melt$date.time<-strptime("","%b/%d/%H:%M")#
for(i in 1:dim(temp.multi.dif.melt)[1]) {#
temp.multi.dif.melt[i,"date.time"]<-as.character(files[gsub("(exp[[:digit:]]+)(.tif)","\\1",files$V9)==temp.multi.dif.melt$setfiles[i],"date.time"])#
}#
#
temp.multi.dif.melt$ZT<-as.numeric(temp.multi.dif.melt$date.time - strptime(first_day_ZT0,"%b/%d/%H:%M"), units = "hours",format="%b/%d/%H:%M") #
	return(temp.multi.dif.melt)#
}#
#
# function exp3set2 special#
# functin for "multi" output (under construction)#
format.luc2data.multi.exp3set2special<-function(plant.name,luc2.data,luc2.data.multi,files,first_day_ZT0) { #
	temp.multi<-luc2.data.multi[,c("Slice",grep("^IntDen",names(luc2.data.multi),value=TRUE))]#
	# add file name#
	set.files<-unique(gsub("([[:print:]]+)(exp[[:digit:]]+)","\\2",luc2.data$Label)) # keeping file order (by time)#
	#print(set.files)#
	# remove label file#
	temp.multi$setfiles<-set.files #
	temp.multi<-temp.multi[grep("lab",temp.multi$setfiles,invert=TRUE),]#
	write.csv(temp.multi, file="temp.multi.csv") # and then edit files#
	temp.multi.mod<-read.csv("temp.multi2.csv")#
	# calculate increase/decrease from begining#
	# temp.multi.dif<-as.matrix(temp.multi[,-1])-as.vector(temp.multi[1,-1]) # does not work#
	temp.multi.dif<-sweep(data.matrix(temp.multi.mod[,grep("IntDen",names(temp.multi.mod))]),2,data.matrix(temp.multi.mod[1,grep("IntDen",names(temp.multi.mod))]))	#
	temp.multi.dif<-as.data.frame(temp.multi.dif)#
	temp.multi.dif<-cbind(temp.multi.dif,temp.multi.mod$setfiles)#
	names(temp.multi.dif)[grep("setfiles",names(temp.multi.dif))]<-"setfiles"#
	print(temp.multi.dif)#
#
	# add sample names#
	names(temp.multi.dif)[grep("IntDen",names(temp.multi.dif))]<-plant.name#
	temp.multi.dif#
	print(temp.multi.dif) # Error: id variables not found in data: setfiles#
	# melt#
	temp.multi.dif.melt<-melt(temp.multi.dif,id.var="setfiles")#
	temp.multi.dif.melt[is.na(temp.multi.dif.melt$value),"value"]<-0#
	# treatment#
	temp.multi.dif.melt$treatment<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)(_)(rep[[:digit:]])","\\1",temp.multi.dif.melt$variable)#
	# promoter#
	temp.multi.dif.melt$promoter<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)(_)(rep[[:digit:]])","\\5",temp.multi.dif.melt$variable)#
	# line#
	temp.multi.dif.melt$line<-gsub("(sun|shade)(_)(plate[[:digit:]])(_)(YUC[[:digit:]]+)(_)(line[[:digit:]]+)(_)(rep[[:digit:]])","\\7",temp.multi.dif.melt$variable)	#
# add time point info (under construction)#
#print(files)#
files$date.time<-strptime(paste(files$V6,files$V7,files$V8,sep="/"),"%b/%d/%H:%M")#
#print(files)#
#
temp.multi.dif.melt$date.time<-strptime("","%b/%d/%H:%M")#
for(i in 1:dim(temp.multi.dif.melt)[1]) {#
temp.multi.dif.melt[i,"date.time"]<-as.character(files[gsub("(exp[[:digit:]]+)(.tif)","\\1",files$V9)==temp.multi.dif.melt$setfiles[i],"date.time"])#
}#
#
temp.multi.dif.melt$ZT<-as.numeric(temp.multi.dif.melt$date.time - strptime(first_day_ZT0,"%b/%d/%H:%M"), units = "hours",format="%b/%d/%H:%M") #
	return(temp.multi.dif.melt)#
}
exp4#
# exp4 set1 (add "rep" info to avoid same column name)#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1"),sep=""),#
paste("shade_plate2_YUC8_line2_rep1",sep=""),#
paste("shade_plate3_YUC5_line3_rep1",sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("sun_plate3_",c("YUC9_line2_rep1","YUC8_line2_rep1","YUC5_line2_rep1"),sep=""),#
paste("sun_plate4_YUC5_line3_rep1",sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp4files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4files.txt",skip=2)#
first_day_ZT0<-"Jun/18/06:00"#
exp4set1.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp4files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp4set1.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp4set1.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# exp4 set2#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2_rep1","YUC8_line2_rep1"),sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC8_line2_rep1","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("sun_plate2_",c("YUC9_line2_rep1","YUC8_line2_rep1","YUC5_line2_rep1"),sep=""),#
"sun_plate3_YUC9_line3_rep1"#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set2data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set2data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp4files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4files.txt",skip=2)#
first_day_ZT0<-"Jun/18/06:00"#
exp4set2.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp4files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp4set2.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp4set2.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# summary#
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# exp5#
# ls -lt > exp5set2files.txt # done in set2#
exp5files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5original/exp5files.txt", skip=2) # exp5label.tif is for recording lables of each plants#
#files<-files[!files$V9=="exp5label.tif",]  # remove "exp5label.tif"#
#
# exp5 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC9_line1_rep2","YUC8_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("shade_plate2_",c("YUC9_line3_rep1","YUC9_line3_rep2","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC8_line1_rep2"),sep=""),#
paste("sun_plate3_","YUC5_line3_rep1",sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
first_day_ZT0<-"Jun/25/06:00"#
exp5set1.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp5files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp5set1.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp5set1.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# exp5 set2#
# enter experimental information#
# input genotype and rep by looking "exp5lable.tif" by mannually. Transgenic "line" has to be consistent throughout experiments.#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1","YUC8_line1_rep2","YUC5_line1_rep2"),sep=""),#
paste("shade_plate2_",c("YUC9_line2_rep1","YUC9_line2_rep2","YUC5_line2_rep1","YUC5_line2_rep2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC9_line3_rep2","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1","YUC5_line1_rep2"),sep=""),#
paste("sun_plate2_",c("YUC8_line2_rep1","YUC5_line2_rep1","YUC5_line2_rep2"),sep=""),#
paste("sun_plate3_",c("YUC9_line3_rep1","YUC5_line3_rep1","YUC5_line3_rep2"),sep="")) #
##
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
first_day_ZT0<-"Jun/25/06:00"#
exp5set2.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp5files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp5set2.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp5set2.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p # #
#
# summary (needs to add "exp" name into variable; under construction)#
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p
library(ggplot2);library(reshape2)
exp4#
# exp4 set1 (add "rep" info to avoid same column name)#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1"),sep=""),#
paste("shade_plate2_YUC8_line2_rep1",sep=""),#
paste("shade_plate3_YUC5_line3_rep1",sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("sun_plate3_",c("YUC9_line2_rep1","YUC8_line2_rep1","YUC5_line2_rep1"),sep=""),#
paste("sun_plate4_YUC5_line3_rep1",sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp4files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4files.txt",skip=2)#
first_day_ZT0<-"Jun/18/06:00"#
exp4set1.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp4files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp4set1.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp4set1.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# exp4 set2#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2_rep1","YUC8_line2_rep1"),sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC8_line2_rep1","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("sun_plate2_",c("YUC9_line2_rep1","YUC8_line2_rep1","YUC5_line2_rep1"),sep=""),#
"sun_plate3_YUC9_line3_rep1"#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set2data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set2data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp4files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4files.txt",skip=2)#
first_day_ZT0<-"Jun/18/06:00"#
exp4set2.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp4files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp4set2.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp4set2.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# summary#
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# exp5#
# ls -lt > exp5set2files.txt # done in set2#
exp5files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5original/exp5files.txt", skip=2) # exp5label.tif is for recording lables of each plants#
#files<-files[!files$V9=="exp5label.tif",]  # remove "exp5label.tif"#
#
# exp5 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC9_line1_rep2","YUC8_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1"),sep=""),#
paste("shade_plate2_",c("YUC9_line3_rep1","YUC9_line3_rep2","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC8_line1_rep2"),sep=""),#
paste("sun_plate3_","YUC5_line3_rep1",sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
first_day_ZT0<-"Jun/25/06:00"#
exp5set1.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp5files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp5set1.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp5set1.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p # #
# exp5 set2#
# enter experimental information#
# input genotype and rep by looking "exp5lable.tif" by mannually. Transgenic "line" has to be consistent throughout experiments.#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1","YUC8_line1_rep2","YUC5_line1_rep2"),sep=""),#
paste("shade_plate2_",c("YUC9_line2_rep1","YUC9_line2_rep2","YUC5_line2_rep1","YUC5_line2_rep2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC9_line3_rep2","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1","YUC5_line1_rep2"),sep=""),#
paste("sun_plate2_",c("YUC8_line2_rep1","YUC5_line2_rep1","YUC5_line2_rep2"),sep=""),#
paste("sun_plate3_",c("YUC9_line3_rep1","YUC5_line3_rep1","YUC5_line3_rep2"),sep="")) #
##
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
first_day_ZT0<-"Jun/25/06:00"#
exp5set2.luc2.data.multi<-format.luc2data.multi(plant.name,luc2.data,luc2.data.multi,files=exp5files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp5set2.luc2.data.multi)#
library(ggplot2)#
p<-ggplot(exp5set2.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p # #
#
# summary (needs to add "exp" name into variable; under construction)#
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p <- p + scale_y_continuous(limits=c(-10000,10000))#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p <- p + scale_y_continuous(limits=c(-5000,10000))#
p
exp5set2.luc2.data.multi<-exp5set2.luc2.data.multi[exp5set2.luc2.data.multi$ZT< 54,]
p<-ggplot(exp5set2.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point() #
p<-p + facet_wrap(treatment~promoter)#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p <- p + scale_y_continuous(limits=c(-5000,10000))#
p
exp3#
exp3files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3original/exp3files.txt",skip=2)#
first_day_ZT0<-"Jun/11/06:00"#
#
## exp3 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1"),sep=""),#
paste("shade_plate2_YUC8_line2_rep1",sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC5_line3_rep1","YUC8_line3_rep2"),sep=""),#
paste("sun_plate1_",c("YUC9_line2_rep1","YUC5_line2_rep1","YUC8_line2_rep1"),sep=""),#
paste("sun_plate2_",c("YUC9_line1_rep1","YUC5_line1_rep1"),sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp3set1.luc2.data.multi<-format.luc2data.multi.exp3set2special(plant.name,luc2.data,luc2.data.multi,files=exp3files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp3set1.luc2.data.multi)#
test<-exp3set1.luc2.data.multi#
test<-test[test$value> -100000 & test$value < 10000,]#
#
p<-ggplot(test, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p
exp3#
exp3files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3original/exp3files.txt",skip=2)#
first_day_ZT0<-"Jun/11/06:00"#
#
## exp3 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1"),sep=""),#
paste("shade_plate2_YUC8_line2_rep1",sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC5_line3_rep1","YUC8_line3_rep2"),sep=""),#
paste("sun_plate1_",c("YUC9_line2_rep1","YUC5_line2_rep1","YUC8_line2_rep1"),sep=""),#
paste("sun_plate2_",c("YUC9_line1_rep1","YUC5_line1_rep1"),sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp3set1.luc2.data.multi<-format.luc2data.multi.exp3set2special(plant.name,luc2.data,luc2.data.multi,files=exp3files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp3set1.luc2.data.multi)#
test<-exp3set1.luc2.data.multi#
test<-test[test$value> -100000 & test$value < 10000,]
getwd()
getwd()
exp3#
exp3files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3original/exp3files.txt",skip=2)#
first_day_ZT0<-"Jun/11/06:00"#
#
## exp3 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1"),sep=""),#
paste("shade_plate2_YUC8_line2_rep1",sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC5_line3_rep1","YUC8_line3_rep2"),sep=""),#
paste("sun_plate1_",c("YUC9_line2_rep1","YUC5_line2_rep1","YUC8_line2_rep1"),sep=""),#
paste("sun_plate2_",c("YUC9_line1_rep1","YUC5_line1_rep1"),sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3set1data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp3/exp3set1data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
exp3set1.luc2.data.multi<-format.luc2data.multi.exp3set2special(plant.name,luc2.data,luc2.data.multi,files=exp3files,first_day_ZT0=first_day_ZT0) # under construction (070214)#
head(exp3set1.luc2.data.multi)#
test<-exp3set1.luc2.data.multi#
test<-test[test$value> -100000 & test$value < 10000,]
p<-ggplot(test, aes(x=ZT,y=value,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter)#
p
exp4 set2#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2","YUC8_line2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3","YUC8_line2","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("sun_plate2_",c("YUC9_line2","YUC8_line2","YUC5_line2"),sep=""),#
"sun_plate3_YUC9_line3"#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set2data.csv")#
luc2.data<-luc2.data[grep("label",luc2.data$Label,invert=TRUE),]#
exp4set2.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp4files)#
head(exp4set2.luc2.data)#
library(ggplot2)#
p<-ggplot(exp4set2.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_wrap(treatment~promoter,scales="free")#
p
p<-ggplot(exp4set2.luc2.data, aes(x=ZT,y=IntDen,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter,scales="free")#
p
exp5 set2#
# enter experimental information#
# input genotype and rep by looking "exp5lable.tif" by mannually. Transgenic "line" has to be consistent throughout experiments.#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2","YUC9_line2","YUC5_line2","YUC5_line2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1","YUC5_line1"),sep=""),#
paste("sun_plate2_",c("YUC8_line2","YUC5_line2","YUC5_line2"),sep=""),#
paste("sun_plate3_",c("YUC9_line3","YUC5_line3","YUC5_line3"),sep="")) #
##
setwd("/Volumes/Data6/data_JM4/promYUC_luc2/exp5")#
luc2.data<-read.csv("set2data.csv") # data is output of "measure" in Multimeasure ROI window (not "multi")#
luc2.data<-luc2.data[!luc2.data$Label=="set2.tif:exp5label",]#
dim(luc2.data)#
#
exp5set2.luc2.data<-format.luc2data(plant.name,luc2.data,files)#
head(exp5set2.luc2.data)#
p<-ggplot(rbind(exp5set2.luc2.data,exp4set2.luc2.data,exp5set1.luc2.data,exp5set2.luc2.data), aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
exp5 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1"),sep=""),#
paste("sun_plate3_","YUC5_line3",sep="")#
)#
#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/set1data.csv")#
luc2.data<-luc2.data[grep("label",luc2.data$Label,invert=TRUE),]#
exp5set1.luc2.data<-format.luc2data(plant.name,luc2.data,files)#
p<-ggplot(rbind(exp5set1.luc2.data,exp4set2.luc2.data,exp5set1.luc2.data,exp5set2.luc2.data), aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.csv")
exp5 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1"),sep=""),#
paste("sun_plate3_","YUC5_line3",sep="")#
)#
#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.csv")#
luc2.data<-luc2.data[grep("label",luc2.data$Label,invert=TRUE),]#
exp5set1.luc2.data<-format.luc2data(plant.name,luc2.data,files)#
p<-ggplot(rbind(exp5set1.luc2.data,exp4set2.luc2.data,exp5set1.luc2.data,exp5set2.luc2.data), aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
ls -lt > exp5set2files.txt # done in set2#
exp5files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5original/exp5files.txt", skip=2) # exp5label.tif is for recording lables of each plants#
#files<-files[!files$V9=="exp5label.tif",]  # remove "exp5label.tif"#
#
# exp5 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1"),sep=""),#
paste("sun_plate3_","YUC5_line3",sep="")#
)#
#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.csv")#
luc2.data<-luc2.data[grep("label",luc2.data$Label,invert=TRUE),]#
exp5set1.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp5files)#
p<-ggplot(rbind(exp5set1.luc2.data,exp4set2.luc2.data,exp5set1.luc2.data,exp5set2.luc2.data), aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
p<-ggplot(exp5set1.luc2.data), aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
exp5set1.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp5files)
exp5set1.luc2.data
head(exp5set1.luc2.data)
p<-ggplot(exp5set1.luc2.data), aes(x=ZT,y=IntDen)) + geom_point()
p<-ggplot(exp5set1.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2","YUC9_line2","YUC5_line2","YUC5_line2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1","YUC5_line1"),sep=""),#
paste("sun_plate2_",c("YUC8_line2","YUC5_line2","YUC5_line2"),sep=""),#
paste("sun_plate3_",c("YUC9_line3","YUC5_line3","YUC5_line3"),sep="")) #
##
setwd("/Volumes/Data6/data_JM4/promYUC_luc2/exp5")#
luc2.data<-read.csv("set2data.csv") # data is output of "measure" in Multimeasure ROI window (not "multi")#
luc2.data<-luc2.data[!luc2.data$Label=="set2.tif:exp5label",]#
dim(luc2.data)#
#
exp5set2.luc2.data<-format.luc2data(plant.name,luc2.data,files)#
head(exp5set2.luc2.data)#
p<-ggplot(exp5set2.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
setwd("/Volumes/Data6/data_JM4/promYUC_luc2/exp5")#
luc2.data<-read.csv("exp5set2data.csv") # data is output of "measure" in Multimeasure ROI window (not "multi")#
luc2.data<-luc2.data[!luc2.data$Label=="set2.tif:exp5label",]#
dim(luc2.data)#
#
exp5set2.luc2.data<-format.luc2data(plant.name,luc2.data,files)#
head(exp5set2.luc2.data)#
p<-ggplot(exp5set2.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
exp5set2.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp5files)
head(exp5set2.luc2.data)#
p<-ggplot(exp5set2.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p <- p + scale_y_continuous(limits=c(-5000,10000))#
p
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value,color=line)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
#p <- p + scale_y_continuous(limits=c(-5000,10000))#
p
ggsave(filename="test.pdf",width=8,length=20)
ggsave(filename="test.pdf",width=8,height=20)
ggsave(filename="test.pdf",width=11,height=20)
p<-ggplot(rbind(exp4set1.luc2.data.multi,exp4set2.luc2.data.multi,exp5set1.luc2.data.multi,exp5set2.luc2.data.multi), aes(x=ZT,y=value)) + geom_point() + geom_smooth()#
p<-p + facet_wrap(treatment~promoter)#
p
ggsave(filename="test.pdf",width=11,height=20)
promoterYUCluc2.R#
###
###########
# measurment note; radias is "50".#
# set scale#
# exp4#
# exp4 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC8_line1"),sep=""),#
paste("shade_plate2_YUC8_line2",sep=""),#
paste("shade_plate3_YUC5_line3",sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC5_line1"),sep=""),#
paste("sun_plate3_",c("YUC9_line2","YUC8_line2","YUC5_line2"),sep=""),#
paste("sun_plate4_YUC5_line3",sep="")#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set1data.csv") # need to scale!#
luc2.data<-luc2.data[grep("lab",luc2.data$Label,invert=TRUE),]#
exp4files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4files.txt",skip=2)#
exp4set1.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp4files)#
head(exp4set1.luc2.data)#
library(ggplot2)#
p<-ggplot(exp4set1.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_wrap(treatment~promoter,scales="free")#
p # #
#
# #
# reshape(exp4set1.luc2.data,direction="wide") # reshaping was not successful (070201). Change output from ImageJ into "multi"#
# exp4 set2#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2","YUC8_line2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3","YUC8_line2","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("sun_plate2_",c("YUC9_line2","YUC8_line2","YUC5_line2"),sep=""),#
"sun_plate3_YUC9_line3"#
)#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp4/exp4set2data.csv")#
luc2.data<-luc2.data[grep("label",luc2.data$Label,invert=TRUE),]#
exp4set2.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp4files)#
head(exp4set2.luc2.data)#
library(ggplot2)#
p<-ggplot(exp4set2.luc2.data, aes(x=ZT,y=IntDen,color=line)) + geom_point()#
p<-p + facet_wrap(treatment~promoter,scales="free")#
p # #
# exp5#
# ls -lt > exp5set2files.txt # done in set2#
exp5files<-read.table("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5original/exp5files.txt", skip=2) # exp5label.tif is for recording lables of each plants#
#files<-files[!files$V9=="exp5label.tif",]  # remove "exp5label.tif"#
#
# exp5 set1#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1"),sep=""),#
paste("sun_plate3_","YUC5_line3",sep="")#
)#
#
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set1data.csv")#
luc2.data<-luc2.data[grep("label",luc2.data$Label,invert=TRUE),]#
exp5set1.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp5files)#
p<-ggplot(exp5set1.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p # #
#
# exp5 set2#
# enter experimental information#
# input genotype and rep by looking "exp5lable.tif" by mannually. Transgenic "line" has to be consistent throughout experiments.#
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1","YUC8_line1","YUC8_line1","YUC5_line1","YUC5_line1"),sep=""),#
paste("shade_plate2_",c("YUC9_line2","YUC9_line2","YUC5_line2","YUC5_line2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3","YUC9_line3","YUC5_line3"),sep=""),#
paste("sun_plate1_",c("YUC9_line1","YUC8_line1","YUC5_line1","YUC5_line1"),sep=""),#
paste("sun_plate2_",c("YUC8_line2","YUC5_line2","YUC5_line2"),sep=""),#
paste("sun_plate3_",c("YUC9_line3","YUC5_line3","YUC5_line3"),sep="")) #
##
setwd("/Volumes/Data6/data_JM4/promYUC_luc2/exp5")#
luc2.data<-read.csv("exp5set2data.csv") # data is output of "measure" in Multimeasure ROI window (not "multi")#
luc2.data<-luc2.data[!luc2.data$Label=="set2.tif:exp5label",]#
dim(luc2.data)#
#
exp5set2.luc2.data<-format.luc2data(plant.name,luc2.data,files=exp5files)#
head(exp5set2.luc2.data)#
p<-ggplot(exp5set2.luc2.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p # #
#
# plot (summary)#
all.data<-rbind(exp4set1.luc2.data,exp4set2.luc2.data,exp5set1.luc2.data,exp5set2.luc2.data)#
summary(all.data)#
library(ggplot2)#
p<-ggplot(all.data, aes(x=ZT,y=IntDen)) + geom_point()#
p<-p + facet_grid(treatment~promoter)#
p # #
# which output J used? IntDen (but it does not matter becasue we do not calibrate images. See ImageJ instruction)#
ggsave(file="absolute.test.pdf")
p<-ggplot(exp5set2.luc2.data.multi, aes(x=ZT,y=value,color=line)) + geom_point() #
p<-p + facet_wrap(treatment~promoter)#
p
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.multi.csv") # need to scale!
luc2.data.multi
exp5set2.luc2.data.multi
exp5set2.luc2.data.multi
luc2.data.multi
plant.name<-c(#
paste("shade_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1","YUC8_line1_rep2","YUC5_line1_rep2"),sep=""),#
paste("shade_plate2_",c("YUC9_line2_rep1","YUC9_line2_rep2","YUC5_line2_rep1","YUC5_line2_rep2"),sep=""),#
paste("shade_plate3_",c("YUC9_line3_rep1","YUC9_line3_rep2","YUC5_line3_rep1"),sep=""),#
paste("sun_plate1_",c("YUC9_line1_rep1","YUC8_line1_rep1","YUC5_line1_rep1","YUC5_line1_rep2"),sep=""),#
paste("sun_plate2_",c("YUC8_line2_rep1","YUC5_line2_rep1","YUC5_line2_rep2"),sep=""),#
paste("sun_plate3_",c("YUC9_line3_rep1","YUC5_line3_rep1","YUC5_line3_rep2"),sep="")) #
##
luc2.data<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.csv") #
luc2.data.multi<-read.csv("/Volumes/Data6/data_JM4/promYUC_luc2/exp5/exp5set2data.multi.csv") # need to scale!#
#luc2.data.multi<-luc2.data.multi[grep("lab",luc2.data.multi$Label,invert=TRUE),]#
first_day_ZT0<-"Jun/25/06:00"
calculate increase/decrease from begining#
#	temp.multi.dif<-as.matrix(temp.multi[,-1])-as.vector(temp.multi[1,-1]) # does not work#
	temp.multi.dif<-sweep(data.matrix(temp.multi[,grep("IntDen",names(temp.multi))]),2,data.matrix(temp.multi[1,grep("IntDen",names(temp.multi))]))#
	temp.multi.dif<-as.data.frame(temp.multi.dif)
temp.multi<-luc2.data.multi[,c("Slice",grep("^IntDen",names(luc2.data.multi),value=TRUE))]#
	# add file name#
	set.files<-unique(gsub("([[:print:]]+)(exp[[:digit:]]+)","\\2",luc2.data$Label)) # keeping file order (by time)#
	#print(set.files)#
	# remove label file#
	temp.multi$setfiles<-set.files#
	temp.multi<-temp.multi[grep("lab",temp.multi$setfiles,invert=TRUE),]
calculate increase/decrease from begining#
#	temp.multi.dif<-as.matrix(temp.multi[,-1])-as.vector(temp.multi[1,-1]) # does not work#
	temp.multi.dif<-sweep(data.matrix(temp.multi[,grep("IntDen",names(temp.multi))]),2,data.matrix(temp.multi[1,grep("IntDen",names(temp.multi))]))#
	temp.multi.dif<-as.data.frame(temp.multi.dif)
temp.multi.dif<-cbind(temp.multi.dif,temp.multi$setfiles)
temp.multi.dif
temp.multi<-luc2.data.multi[,c("Slice",grep("^IntDen",names(luc2.data.multi),value=TRUE))]#
	# add file name#
	set.files<-unique(gsub("([[:print:]]+)(exp[[:digit:]]+)","\\2",luc2.data$Label)) # keeping file order (by time)#
	#print(set.files)#
	# remove label file#
	temp.multi$setfiles<-set.files#
	temp.multi<-temp.multi[grep("lab",temp.multi$setfiles,invert=TRUE),]
temp.multi
exp5set2.luc2.data.multi
luc2.data.multi
q()
